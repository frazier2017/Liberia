xy<-ppp(x,y,c(0,1),c(0,1))
summary(xy)
dens<-density(xy)
plot(xy)
plot(density(xy))
x<-runif(10,0,1)
y<-runif(10,0,1)
xy<-ppp(x,y,c(0,1),c(0,1))
summary(xy)
dens<-density(xy)
summary(dens)
plot(xy)
plot(density(xy))
plot(xy)
plot(density(xy))
identify(ppp0)
identify.ppp(xy)
plot.new()
identify.ppp(xy)
rm(list=ls())
setwd("~/GitHub/Liberia")
library(rgdal)
library(dplyr)
library(rgeos)
library(ggmap)
library(raster)
library(spatstat)
library(maptools)
library(sp)
library(foreign)
library(knitr)
library(gridExtra)
library(rasterVis)
library(colorspace)
library(mapdata)
library(rgl)
library(scales)
library(plot3Drgl)
library(akima)
##
#### DATA ####
## Import Shapefiles ##
country<-readOGR(dsn="shapefiles", layer="liberia_revised",stringsAsFactors=FALSE, verbose=FALSE)
cnty<-readOGR(dsn = "shapefiles",layer="counties",stringsAsFactors = FALSE,verbose=FALSE)
dist<-readOGR(dsn="shapefiles",layer="districts", stringsAsFactors = FALSE,verbose = FALSE)
clan<-readOGR(dsn="shapefiles",layer="clans", stringsAsFactors = FALSE,verbose = FALSE)
country<-spTransform(country, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
cnty<-spTransform(cnty, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
dist<-spTransform(dist, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
clan<-spTransform(clan, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
### Fortify shapefiles ###
country_f<-fortify(country)
cnty_f<-fortify(cnty)
dist_f<-fortify(dist)
clan_f<-fortify(clan)
## Import GPW4 data ##
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
gpw4_2000<-crop(gpw4_2000,extent(country))
gpw4_2000<-mask(gpw4_2000,country)
gpw4_2005<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2005.tif")
gpw4_2005<-crop(gpw4_2005,extent(country))
gpw4_2005<-mask(gpw4_2005,country)
gpw4_2010<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2010.tif")
gpw4_2010<-crop(gpw4_2010,extent(country))
gpw4_2010<-mask(gpw4_2010,country)
gpw4_2015<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2015.tif")
gpw4_2015<-crop(gpw4_2015,extent(country))
gpw4_2015<-mask(gpw4_2015,country)
## Calculate growth rate ##
growth_00_05<-overlay(gpw4_2000,gpw4_2005,fun=function(r1,r2){return((r2-r1)/r1)})
growth_05_10<-overlay(gpw4_2005,gpw4_2010,fun=function(r1,r2){return((r2-r1)/r1)})
growth_10_15<-overlay(gpw4_2010,gpw4_2015,fun=function(r1,r2){return((r2-r1)/r1)})
## Load final data ##
load("lbr_data_final.RData")
lbr_data_final_NE<- spTransform(lbr_data_final, CRS("+proj=utm +zone=30 ellps=WGS84"))
lat = c(51.501476)
lon = c(-0.140634)
xy = data.frame(lon, lat)
coordinates(xy) <- c("lon", "lat")
proj4string(xy) <- CRS("+proj=longlat +datum=WGS84")
NE <- spTransform(xy, CRS("+proj=utm +zone=30 ellps=WGS84"))
NE <- as.data.frame(NE)
View(NE)
xy = data.frame(lon, lat)
lbr_data_final_NE<-lbr_data_final
coordinates(lbr_data_final_NE)<-c("lon","lat")
coordinates(lbr_data_final_NE)<-c("long","lat")
proj4string(lbr_data_final_NE)<-CRS("+proj=longlat +datum=WGS84")
lbr_data_final_NE<- spTransform(lbr_data_final_NE, CRS("+proj=utm +zone=30 ellps=WGS84"))
lbr_data_final_NE<- as.data.frame(lbr_data_final_NE)
View(lbr_data_final_NE)
View(lbr_data_final_NE)
lbr_data_final_NE<-lbr_data_final
coordinates(lbr_data_final_NE)<-c("long","lat")
proj4string(lbr_data_final_NE)<-CRS("+proj=longlat +datum=WGS84")
lbr_data_final_NE<- spTransform(lbr_data_final_NE, CRS("+proj=utm +zone=29 ellps=WGS84"))
lbr_data_final_NE<- as.data.frame(lbr_data_final_NE)
colnames(lbr_data_final_NE)[,c(9,10)]<-c("east","north")
colnames(lbr_data_final_NE)[,c(9:10)]<-c("east","north")
colnames(lbr_data_final_NE)[,9:10]<-c("east","north")
colnames(lbr_data_final_NE)[9:10]<-c("east","north")
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_Ne$north,marks=lbr_data_final_NE$pop2010,window=win)
win<-as(country,"owin")
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_Ne$north,marks=lbr_data_final_NE$pop2010,window=win)
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window=win)
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010)
country_NE<-spTransform(country, CRS("+proj=utm +zone=29 ellps=WGS84"))
win_NE<-as(country,"owin")
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
ppp_test<-ppp(lbr_data_final_NE$north,lbr_data_final_NE$east,marks=lbr_data_final_NE$pop2010,window = win_NE)
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
plot(ppp_test)
country_NE<-spTransform(country, CRS("+proj=utm +zone=29 ellps=WGS84"))
win_NE<-as(country_NE,"owin")
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
plot(ppp_test)
plot(density(ppp_test))
summary(ppp_test)
dens<-density(ppp_test)
summary(dens)
unitname(ppp_test)<-"meters"
summary(ppp_test)
summary(dens)
dens<-density(ppp_test)
summary(dens)
dens<-density(ppp_test,dimyx = c(100,100))
summary(dens)
dens<-density(ppp_test,dimyx = c(150,150))
summary(dens)
dens<-density(ppp_test,dimyx = c(200,200))
summary(dens)
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
ppp_test<-rescale(ppp_test,1/10)
ppp_test<-rescale(ppp_test,(1/10))
ppp_test<-rescale(ppp_test,.1)
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
ppp_test<-rescale(ppp_test,.1)
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
ppp_test<-rescale(ppp_test,.001)
ppp_test<-rescale(ppp_test,1000)
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
rescale(ppp_test,s=1000)
rescale(ppp_test,1000)
library(spatstat)
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
rescale(ppp_test,1000)
country_NE<-spTransform(country, CRS("+proj=utm +zone=29 ellps=WGS84"))
win_NE<-as(country_NE,"owin")
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
rescale(ppp_test,1000)
rescale
ppp_test<-rescale.ppp(ppp_test,1000)
unitname(ppp_test)<-"kilometers"
dens<-density(ppp_test,dimyx = c(200,200))
summary(dens)
plot(ppp_test)
dens<-density(ppp_test)
summary(dens)
plot(dens)
dens<-density(ppp_test,.1)
summary(dens)
plot(dens)
dens<-density(ppp_test,1)
summary(dens)
plot(dens)
plot(dens)
dens<-density(ppp_test,10)
summary(dens)
plot(dens)
rm(list=ls())
setwd("~/GitHub/Liberia")
library(rgdal)
library(dplyr)
library(rgeos)
library(ggmap)
library(raster)
library(spatstat)
library(maptools)
library(sp)
library(foreign)
library(knitr)
library(gridExtra)
library(rasterVis)
library(colorspace)
library(mapdata)
library(rgl)
library(scales)
library(plot3Drgl)
library(akima)
country<-readOGR(dsn="shapefiles", layer="liberia_revised",stringsAsFactors=FALSE, verbose=FALSE)
cnty<-readOGR(dsn = "shapefiles",layer="counties",stringsAsFactors = FALSE,verbose=FALSE)
dist<-readOGR(dsn="shapefiles",layer="districts", stringsAsFactors = FALSE,verbose = FALSE)
clan<-readOGR(dsn="shapefiles",layer="clans", stringsAsFactors = FALSE,verbose = FALSE)
country<-spTransform(country, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
cnty<-spTransform(cnty, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
dist<-spTransform(dist, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
clan<-spTransform(clan, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
country_f<-fortify(country)
cnty_f<-fortify(cnty)
dist_f<-fortify(dist)
clan_f<-fortify(clan)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
gpw4_2000<-crop(gpw4_2000,extent(country))
gpw4_2000<-mask(gpw4_2000,country)
gpw4_2005<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2005.tif")
gpw4_2005<-crop(gpw4_2005,extent(country))
gpw4_2005<-mask(gpw4_2005,country)
gpw4_2010<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2010.tif")
gpw4_2010<-crop(gpw4_2010,extent(country))
gpw4_2010<-mask(gpw4_2010,country)
gpw4_2015<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2015.tif")
gpw4_2015<-crop(gpw4_2015,extent(country))
gpw4_2015<-mask(gpw4_2015,country)
growth_00_05<-overlay(gpw4_2000,gpw4_2005,fun=function(r1,r2){return((r2-r1)/r1)})
growth_05_10<-overlay(gpw4_2005,gpw4_2010,fun=function(r1,r2){return((r2-r1)/r1)})
growth_10_15<-overlay(gpw4_2010,gpw4_2015,fun=function(r1,r2){return((r2-r1)/r1)})
load("lbr_data_final.RData")
cnty@data$SUM_HH[1]<-20508
rm(list=ls())
setwd("~/GitHub/Liberia")
library(rgdal)
library(dplyr)
library(rgeos)
library(ggmap)
library(raster)
library(spatstat)
library(maptools)
library(sp)
library(foreign)
library(knitr)
library(gridExtra)
library(rasterVis)
library(colorspace)
library(mapdata)
library(rgl)
library(scales)
library(plot3Drgl)
library(akima)
country<-readOGR(dsn="shapefiles", layer="liberia_revised",stringsAsFactors=FALSE, verbose=FALSE)
cnty<-readOGR(dsn = "shapefiles",layer="counties",stringsAsFactors = FALSE,verbose=FALSE)
dist<-readOGR(dsn="shapefiles",layer="districts", stringsAsFactors = FALSE,verbose = FALSE)
clan<-readOGR(dsn="shapefiles",layer="clans", stringsAsFactors = FALSE,verbose = FALSE)
country<-spTransform(country, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
cnty<-spTransform(cnty, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
dist<-spTransform(dist, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
clan<-spTransform(clan, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
country_f<-fortify(country)
cnty_f<-fortify(cnty)
dist_f<-fortify(dist)
gpw4_2010<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2010.tif")
clan_f<-fortify(clan)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
gpw4_2000<-crop(gpw4_2000,extent(country))
gpw4_2000<-mask(gpw4_2000,country)
gpw4_2005<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2005.tif")
gpw4_2005<-crop(gpw4_2005,extent(country))
gpw4_2005<-mask(gpw4_2005,country)
gpw4_2010<-crop(gpw4_2010,extent(country))
gpw4_2010<-mask(gpw4_2010,country)
gpw4_2015<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2015.tif")
gpw4_2015<-crop(gpw4_2015,extent(country))
gpw4_2015<-mask(gpw4_2015,country)
growth_00_05<-overlay(gpw4_2000,gpw4_2005,fun=function(r1,r2){return((r2-r1)/r1)})
growth_05_10<-overlay(gpw4_2005,gpw4_2010,fun=function(r1,r2){return((r2-r1)/r1)})
growth_10_15<-overlay(gpw4_2010,gpw4_2015,fun=function(r1,r2){return((r2-r1)/r1)})
load("lbr_data_final.RData")
lbr_data_final_NE<-lbr_data_final
coordinates(lbr_data_final_NE)<-c("long","lat")
proj4string(lbr_data_final_NE)<-CRS("+proj=longlat +datum=WGS84")
lbr_data_final_NE<- spTransform(lbr_data_final_NE, CRS("+proj=utm +zone=29 ellps=WGS84"))
lbr_data_final_NE<- as.data.frame(lbr_data_final_NE)
colnames(lbr_data_final_NE)[9:10]<-c("east","north")
country_NE<-spTransform(country, CRS("+proj=utm +zone=29 ellps=WGS84"))
win_NE<-as(country_NE,"owin")
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
ppp_test<-rescale.ppp(ppp_test,1000)
unitname(ppp_test)<-"kilometers"
plot(ppp_test)
summary(ppp_test)
dens<-density(ppp_test)
summary(dens)
mean(lbr_data_final_NE$pop2010)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
load("gpw4_lbr_spdf.RData")
View(y)
as.owin(y[1:4,])
as.owin(y[1:4,1],y[1:4,2])
as.owin(c(-9.775000,-9.766667),c(8.550000,8.541667))
owin(c(-9.775000,-9.766667),c(8.550000,8.541667))
owin(c(-9.775000,-9.766667),yrange=c(8.550000,8.541667))
owin(xrange=c(-9.775000,-9.766667),yrange=c(8.550000,8.541667))
owin(xrange=c(-9.775000,-9.766667),yrange=c(8.541667,8.550000,))
owin(xrange=c(-9.775000,-9.766667),yrange=c(8.541667,8.550000))
win1<-owin(xrange=c(-9.775000,-9.766667),yrange=c(8.541667,8.550000))
gpw4_2000<-extract(gpw4_2000,clans)
gpw4_2000_clan<-extract(gpw4_2000,clan)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
gpw4_2000<-crop(gpw4_2000,extent(country))
gpw4_2000_clan<-extract(gpw4_2000,clan)
gpw4_2000_clan<-extract(gpw4_2000,clan,df=TRUE)
View(gpw4_2000_clan)
View(gpw4_2000_clan)
gpw4_2000_clan2<-aggregate(.~ID)
gpw4_2000_clan2<-aggregate(.~ID,gpw4_2000_clan)
gpw4_2000_clan2<-aggregate(.~ID,gpw4_2000_clan,fun=sum)
gpw4_2000_clan2<-aggregate(.~ID,gpw4_2000_clan,FUN=sum)
View(gpw4_2000_clan2)
gpw4_2000_clan<-aggregate(.~ID,gpw4_2000_clan,FUN=sum)
rm(gpw4_2000_clan2)
View(clan_f)
gpw4_2000_clan<-extract(gpw4_2000,clan,df=TRUE)
View(gpw4_2000_clan)
View(gpw4_2000_clan)
View(clan_f)
clan_f$id<-clan_f$id + 1
gpw4_2000_clan<-aggregate(.~ID,gpw4_2000_clan,FUN=sum)
gpw4_2000_clan$ID<-[0:215]
gpw4_2000_clan$ID<-seq(0:215)
gpw4_2000_clan$ID<-seq(0:815)
gpw4_2000_clan$ID<-seq(0,815)
clan_f_sum<-clan_f
clan_f_sum$x<-1
View(clan_f_sum)
clan_f_sum<-aggregate(x~id,clan_f_sum)
clan_f_sum<-aggregate(x~id,clan_f_sum,FUN=sum)
gpw4_2000_clan2<-gpw4_2000_clan
View(gpw4_2000_clan2)
gpw4_2000_clan2$gpw.v4.population.count_2000<-gpw4_2000_clan2$gpw.v4.population.count_2000/clan_f_sum$x
clan_df<-left_join(clan_f,gpw4_2000_clan,by=c("id","ID"))
clan_df<-left_join(clan_f,gpw4_2000_clan,by=c("id"="ID"))
gpw4_2000_clan$ID<-as.character(seq(0,815))
gpw4_2000_clan2<-gpw4_2000_clan
gpw4_2000_clan2$gpw.v4.population.count_2000<-gpw4_2000_clan2$gpw.v4.population.count_2000/clan_f_sum$x
clan_df<-left_join(clan_f,gpw4_2000_clan,by=c("id"="ID"))
View(clan_df)
clan_df<-left_join(clan_df,gpw4_2000_clan2,by=c("id"="ID"))
list_owin<-list()
for (id in clan_df$id){
sub<-clan_df[which(clan_df$id==id)]
win<-owin(poly=sub)
list_owin[i]<-win
}
for (id in clan_df$id){
sub<-clan_df[which(clan_df$id==as.character(id))]
win<-owin(poly=sub)
list_owin[i]<-win
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
win<-owin(poly=sub)
list_owin[i]<-win
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
win<-owin(poly=sub2)
list_owin[i]<-win
}
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
View(sub2)
win<-owin(poly=sub2)
sub2<-unique(sub2)
win<-owin(poly=sub2)
View(sub2)
win<-owin(poly=list(x=sub2$long,x=sub2$lat))
win<-owin(poly=list(x=rev(sub2$long),x=rev(sub2$lat)))
win<-owin(poly=data.frame(x=rev(sub2$long),x=rev(sub2$lat)))
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin[i]<-win
}
list_owin<-list()
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin[id]<-win
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin[id]<-win
}
list_owin[1]
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
sub<-subset(clan_df,clan_df$id==as.character(1))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win2<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list(win,win2)
x<-list(win,win2)
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-list(list_owin,win)
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-list_owin+win
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
}
list_owin<-list()
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
}
list_owin<-list()
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-list()
rm(ist())
rm(  ist
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
}
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
sub<-subset(clan_df,clan_df$id==as.character(1))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win2<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
x<-list(win,win2)
list_owin[1]
load("gpw4_lbr_spdf.RData")
win1<-owin(xrange=c(-9.775000,-9.766667),yrange=c(8.541667,8.550000))
win1<-runifpoint()
#### CHANGE COORDINATES ####
lbr_data_final_NE<-lbr_data_final
coordinates(lbr_data_final_NE)<-c("long","lat")
proj4string(lbr_data_final_NE)<-CRS("+proj=longlat +datum=WGS84")
lbr_data_final_NE<- spTransform(lbr_data_final_NE, CRS("+proj=utm +zone=29 ellps=WGS84"))
lbr_data_final_NE<- as.data.frame(lbr_data_final_NE)
colnames(lbr_data_final_NE)[9:10]<-c("east","north")
country_NE<-spTransform(country, CRS("+proj=utm +zone=29 ellps=WGS84"))
win_NE<-as(country_NE,"owin")
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
ppp_test<-rescale.ppp(ppp_test,1000)
unitname(ppp_test)<-"kilometers"
plot(ppp_test)
list_owin<-list()
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
sub<-subset(clan_df,clan_df$id==as.character(1))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win2<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win2)
list_owin<-list()
list_owin<-list()
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,list(win))
sub<-subset(clan_df,clan_df$id==as.character(1))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win2<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,list(win2))
list_owin[1]
class(list_owin[1])
tess1<-tess(tiles=list_owin)
plot(tess)
plot(tess1)
list_owin<-list()
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,list(win))
}
tess2<-tess(list_owin)
tess2<-tess(tiles=list_owin)
plot(tess2)
