cnty<-spTransform(cnty, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
dist<-spTransform(dist, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
clan<-spTransform(clan, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
country_f<-fortify(country)
cnty_f<-fortify(cnty)
dist_f<-fortify(dist)
gpw4_2010<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2010.tif")
clan_f<-fortify(clan)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
gpw4_2000<-crop(gpw4_2000,extent(country))
gpw4_2000<-mask(gpw4_2000,country)
gpw4_2005<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2005.tif")
gpw4_2005<-crop(gpw4_2005,extent(country))
gpw4_2005<-mask(gpw4_2005,country)
gpw4_2010<-crop(gpw4_2010,extent(country))
gpw4_2010<-mask(gpw4_2010,country)
gpw4_2015<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2015.tif")
gpw4_2015<-crop(gpw4_2015,extent(country))
gpw4_2015<-mask(gpw4_2015,country)
growth_00_05<-overlay(gpw4_2000,gpw4_2005,fun=function(r1,r2){return((r2-r1)/r1)})
growth_05_10<-overlay(gpw4_2005,gpw4_2010,fun=function(r1,r2){return((r2-r1)/r1)})
growth_10_15<-overlay(gpw4_2010,gpw4_2015,fun=function(r1,r2){return((r2-r1)/r1)})
load("lbr_data_final.RData")
lbr_data_final_NE<-lbr_data_final
coordinates(lbr_data_final_NE)<-c("long","lat")
proj4string(lbr_data_final_NE)<-CRS("+proj=longlat +datum=WGS84")
lbr_data_final_NE<- spTransform(lbr_data_final_NE, CRS("+proj=utm +zone=29 ellps=WGS84"))
lbr_data_final_NE<- as.data.frame(lbr_data_final_NE)
colnames(lbr_data_final_NE)[9:10]<-c("east","north")
country_NE<-spTransform(country, CRS("+proj=utm +zone=29 ellps=WGS84"))
win_NE<-as(country_NE,"owin")
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
ppp_test<-rescale.ppp(ppp_test,1000)
unitname(ppp_test)<-"kilometers"
plot(ppp_test)
summary(ppp_test)
dens<-density(ppp_test)
summary(dens)
mean(lbr_data_final_NE$pop2010)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
load("gpw4_lbr_spdf.RData")
View(y)
as.owin(y[1:4,])
as.owin(y[1:4,1],y[1:4,2])
as.owin(c(-9.775000,-9.766667),c(8.550000,8.541667))
owin(c(-9.775000,-9.766667),c(8.550000,8.541667))
owin(c(-9.775000,-9.766667),yrange=c(8.550000,8.541667))
owin(xrange=c(-9.775000,-9.766667),yrange=c(8.550000,8.541667))
owin(xrange=c(-9.775000,-9.766667),yrange=c(8.541667,8.550000,))
owin(xrange=c(-9.775000,-9.766667),yrange=c(8.541667,8.550000))
win1<-owin(xrange=c(-9.775000,-9.766667),yrange=c(8.541667,8.550000))
gpw4_2000<-extract(gpw4_2000,clans)
gpw4_2000_clan<-extract(gpw4_2000,clan)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
gpw4_2000<-crop(gpw4_2000,extent(country))
gpw4_2000_clan<-extract(gpw4_2000,clan)
gpw4_2000_clan<-extract(gpw4_2000,clan,df=TRUE)
View(gpw4_2000_clan)
View(gpw4_2000_clan)
gpw4_2000_clan2<-aggregate(.~ID)
gpw4_2000_clan2<-aggregate(.~ID,gpw4_2000_clan)
gpw4_2000_clan2<-aggregate(.~ID,gpw4_2000_clan,fun=sum)
gpw4_2000_clan2<-aggregate(.~ID,gpw4_2000_clan,FUN=sum)
View(gpw4_2000_clan2)
gpw4_2000_clan<-aggregate(.~ID,gpw4_2000_clan,FUN=sum)
rm(gpw4_2000_clan2)
View(clan_f)
gpw4_2000_clan<-extract(gpw4_2000,clan,df=TRUE)
View(gpw4_2000_clan)
View(gpw4_2000_clan)
View(clan_f)
clan_f$id<-clan_f$id + 1
gpw4_2000_clan<-aggregate(.~ID,gpw4_2000_clan,FUN=sum)
gpw4_2000_clan$ID<-[0:215]
gpw4_2000_clan$ID<-seq(0:215)
gpw4_2000_clan$ID<-seq(0:815)
gpw4_2000_clan$ID<-seq(0,815)
clan_f_sum<-clan_f
clan_f_sum$x<-1
View(clan_f_sum)
clan_f_sum<-aggregate(x~id,clan_f_sum)
clan_f_sum<-aggregate(x~id,clan_f_sum,FUN=sum)
gpw4_2000_clan2<-gpw4_2000_clan
View(gpw4_2000_clan2)
gpw4_2000_clan2$gpw.v4.population.count_2000<-gpw4_2000_clan2$gpw.v4.population.count_2000/clan_f_sum$x
clan_df<-left_join(clan_f,gpw4_2000_clan,by=c("id","ID"))
clan_df<-left_join(clan_f,gpw4_2000_clan,by=c("id"="ID"))
gpw4_2000_clan$ID<-as.character(seq(0,815))
gpw4_2000_clan2<-gpw4_2000_clan
gpw4_2000_clan2$gpw.v4.population.count_2000<-gpw4_2000_clan2$gpw.v4.population.count_2000/clan_f_sum$x
clan_df<-left_join(clan_f,gpw4_2000_clan,by=c("id"="ID"))
View(clan_df)
clan_df<-left_join(clan_df,gpw4_2000_clan2,by=c("id"="ID"))
list_owin<-list()
for (id in clan_df$id){
sub<-clan_df[which(clan_df$id==id)]
win<-owin(poly=sub)
list_owin[i]<-win
}
for (id in clan_df$id){
sub<-clan_df[which(clan_df$id==as.character(id))]
win<-owin(poly=sub)
list_owin[i]<-win
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
win<-owin(poly=sub)
list_owin[i]<-win
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
win<-owin(poly=sub2)
list_owin[i]<-win
}
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
View(sub2)
win<-owin(poly=sub2)
sub2<-unique(sub2)
win<-owin(poly=sub2)
View(sub2)
win<-owin(poly=list(x=sub2$long,x=sub2$lat))
win<-owin(poly=list(x=rev(sub2$long),x=rev(sub2$lat)))
win<-owin(poly=data.frame(x=rev(sub2$long),x=rev(sub2$lat)))
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin[i]<-win
}
list_owin<-list()
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin[id]<-win
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin[id]<-win
}
list_owin[1]
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
sub<-subset(clan_df,clan_df$id==as.character(1))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win2<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list(win,win2)
x<-list(win,win2)
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-list(list_owin,win)
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-list_owin+win
}
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
}
list_owin<-list()
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
}
list_owin<-list()
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-list()
rm(ist())
rm(  ist
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
}
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
sub<-subset(clan_df,clan_df$id==as.character(1))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win2<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
x<-list(win,win2)
list_owin[1]
load("gpw4_lbr_spdf.RData")
win1<-owin(xrange=c(-9.775000,-9.766667),yrange=c(8.541667,8.550000))
win1<-runifpoint()
#### CHANGE COORDINATES ####
lbr_data_final_NE<-lbr_data_final
coordinates(lbr_data_final_NE)<-c("long","lat")
proj4string(lbr_data_final_NE)<-CRS("+proj=longlat +datum=WGS84")
lbr_data_final_NE<- spTransform(lbr_data_final_NE, CRS("+proj=utm +zone=29 ellps=WGS84"))
lbr_data_final_NE<- as.data.frame(lbr_data_final_NE)
colnames(lbr_data_final_NE)[9:10]<-c("east","north")
country_NE<-spTransform(country, CRS("+proj=utm +zone=29 ellps=WGS84"))
win_NE<-as(country_NE,"owin")
ppp_test<-ppp(lbr_data_final_NE$east,lbr_data_final_NE$north,marks=lbr_data_final_NE$pop2010,window = win_NE)
ppp_test<-rescale.ppp(ppp_test,1000)
unitname(ppp_test)<-"kilometers"
plot(ppp_test)
list_owin<-list()
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win)
sub<-subset(clan_df,clan_df$id==as.character(1))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win2<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,win2)
list_owin<-list()
list_owin<-list()
sub<-subset(clan_df,clan_df$id==as.character(0))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,list(win))
sub<-subset(clan_df,clan_df$id==as.character(1))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win2<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,list(win2))
list_owin[1]
class(list_owin[1])
tess1<-tess(tiles=list_owin)
plot(tess)
plot(tess1)
list_owin<-list()
for (id in clan_df$id){
sub<-subset(clan_df,clan_df$id==as.character(id))
sub2<-sub[,1:2]
sub2<-unique(sub2)
win<-owin(poly=data.frame(x=rev(sub2$long),y=rev(sub2$lat)))
list_owin<-c(list_owin,list(win))
}
tess2<-tess(list_owin)
tess2<-tess(tiles=list_owin)
plot(tess2)
load("lbr_data_final.RData")
View(lbr_data_final)
load("gpw4_lbr_spdf.RData")
View(y)
library(rgdal)
library(dplyr)
library(rgeos)
library(ggmap)
library(raster)
library(spatstat)
library(maptools)
library(sp)
library(foreign)
library(knitr)
library(gridExtra)
library(rasterVis)
library(colorspace)
library(mapdata)
library(rgl)
library(scales)
library(plot3Drgl)
library(akima)
country<-readOGR(dsn="shapefiles", layer="liberia_revised",stringsAsFactors=FALSE, verbose=FALSE)
cnty<-readOGR(dsn = "shapefiles",layer="counties",stringsAsFactors = FALSE,verbose=FALSE)
dist<-readOGR(dsn="shapefiles",layer="districts", stringsAsFactors = FALSE,verbose = FALSE)
clan<-readOGR(dsn="shapefiles",layer="clans", stringsAsFactors = FALSE,verbose = FALSE)
country<-spTransform(country, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
cnty<-spTransform(cnty, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
dist<-spTransform(dist, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
clan<-spTransform(clan, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
country_f<-fortify(country)
cnty_f<-fortify(cnty)
dist_f<-fortify(dist)
clan_f<-fortify(clan)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
gpw4_2000<-crop(gpw4_2000,extent(country))
gpw4_2000<-mask(gpw4_2000,country)
gpw4_2005<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2005.tif")
gpw4_2005<-crop(gpw4_2005,extent(country))
gpw4_2005<-mask(gpw4_2005,country)
gpw4_2010<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2010.tif")
gpw4_2010<-crop(gpw4_2010,extent(country))
gpw4_2010<-mask(gpw4_2010,country)
gpw4_2015<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2015.tif")
gpw4_2015<-crop(gpw4_2015,extent(country))
gpw4_2015<-mask(gpw4_2015,country)
growth_00_05<-overlay(gpw4_2000,gpw4_2005,fun=function(r1,r2){return((r2-r1)/r1)})
growth_05_10<-overlay(gpw4_2005,gpw4_2010,fun=function(r1,r2){return((r2-r1)/r1)})
growth_10_15<-overlay(gpw4_2010,gpw4_2015,fun=function(r1,r2){return((r2-r1)/r1)})
load("lbr_data_final.RData")
load("gpw4_lbr_spdf.RData")
data<-cbind(xyFromCell(gpw4_2000,1:ncell(gpw4_2000)),getValues(gpw4_2000))
data<-na.omit(data)
colnames(data)<-c("long","lat","pop2000")
data2<-cbind(xyFromCell(gpw4_2005,1:ncell(gpw4_2005)),getValues(gpw4_2005))
data2<-na.omit(data2)
colnames(data2)<-c("long","lat","pop2005")
data3<-cbind(xyFromCell(gpw4_2010,1:ncell(gpw4_2010)),getValues(gpw4_2010))
data3<-na.omit(data3)
colnames(data3)<-c("long","lat","pop2010")
data4<-cbind(xyFromCell(gpw4_2015,1:ncell(gpw4_2015)),getValues(gpw4_2015))
data4<-na.omit(data4)
colnames(data4)<-c("long","lat","pop2015")
data5<-cbind(xyFromCell(growth_00_05,1:ncell(growth_00_05)),getValues(growth_00_05))
data5<-na.omit(data5)
colnames(data5)<-c("long","lat","growth05")
data6<-cbind(xyFromCell(growth_05_10,1:ncell(growth_05_10)),getValues(growth_05_10))
data6<-na.omit(data6)
colnames(data6)<-c("long","lat","growth10")
data7<-cbind(xyFromCell(growth_10_15,1:ncell(growth_10_15)),getValues(growth_10_15))
data7<-na.omit(data7)
colnames(data7)<-c("long","lat","growth15")
lbr_data_final<-merge(data,data2,by=c("long","lat"))
lbr_data_final<-merge(lbr_data_final,data3,by=c("long","lat"))
lbr_data_final<-merge(lbr_data_final,data4,by=c("long","lat"))
lbr_data_final<-merge(lbr_data_final,data5,by=c("long","lat"))
lbr_data_final<-merge(lbr_data_final,data6,by=c("long","lat"))
lbr_data_final<-merge(lbr_data_final,data7,by=c("long","lat"))
lbr_data_final[,10]<-1:nrow(lbr_data_final)
colnames(lbr_data_final)[10]<-"id"
8.5500000-.5*.008333
-9.775000+.5*.008333
data3<-as.data.frame(data3)
id<-1:nrow(data3)
data3<-cbind(data3,id)
data3$id<-as.character(data3$id)
good_good<-left_join(y,data3,by="id")
colnames(good_good)<-c("long","lat","order","hole","piece","id","group","ct_long","ct_lat","pop2010")
save(good_good,file="good_good.RData")
good_good2<-left_join(good_good,lbr_data_final,by=c(c("ct_long"="long"),c("ct_lat"="lat")))
View(good_good2)
good_good2<-good_good2[,c(1:9,11:17)]
colnames(good_good2)[6]<-"id"
colnames(good_good2)[12]<-"pop2010"
save(good_good2,file="complete_data.RData")
sub<-subset(good_good2,good_good2$id=="1")
system.time(sub<-subset(good_good2,good_good2$id=="1"))
system.time(sub<-subset(good_good2,good_good2$id=="1"))
system.time(sub2<-good_good2[1:5,])
system.time(sub2<-good_good2[(1+(5*(1-1))):(5*1),])
system.time(sub2<-good_good2[(1+(5*(1-1))):(5*1),])
system.time(sub2<-good_good2[(1+(5*(1-1))):(5*1),])
system.time(sub2<-good_good2[(1+(5*(100-1))):(5*100),])
View(sub2)
system.time(sub2<-good_good2[(1+(5*(10000-1))):(5*10000),])
system.time(sub2<-good_good2[(1+(5*(100000-1))):(5*100000),])
sub$pop2010[1]
pops<-good_good2[,c(6,10:16)]
pops[,c(6,10:16)]<-pops[,c(6,10:16)]/5
pops[,c(2:8)]<-pops[,c(2:8)]/5
View(pops)
pops<-aggregate(.~id,gpw4_2000_clan,FUN=sum)
pops<-aggregate(.~id,pops,FUN=sum)
pops$id<-as.character(pops$id)
pops$id<-as.numeric(pops$id)
row.names(pops)<-pops$id
View(sub)
m_final<-matrix(nrow=0,ncol=3)
for (i in 1:nrow(good_good2)){
sub<-good_good2[(1+(5*(i-1))):(5*i),]
m1<-matrix(nrow=0,ncol=3)
while(nrow(m1) < pops[i,4]) {
m2<-matrix(nrow=100,ncol=3)
m2[,1]<-runif(100,max=(max(sub$long,na.rm=T)+.00000001),min = (min(sub$long,na.rm=T)-.00000001))
m2[,2]<-runif(100,max=(max(sub$lat,na.rm=T)+.00000001),min = (min(sub$lat,na.rm=T)-.00000001))
m2[,3]<-point.in.polygon(m2[,1],m2[,2],sub$long,sub$lat)
m2<-subset(m2, m2[,3]>0)
m1<-rbind(m1,m2)
m1<-unique(m1)
}
m1<-m1[1:pops[i,4],]
m_final<-rbind(m_final,m1)
}
View(m_final)
pops[,c(2:8)]<-round(pops[,c(2:8)]/10,0)
m_final<-matrix(nrow=0,ncol=3)
for (i in 1:nrow(good_good2)){
sub<-good_good2[(1+(5*(i-1))):(5*i),]
m1<-matrix(nrow=0,ncol=3)
while(nrow(m1) < pops[i,4]) {
m2<-matrix(nrow=100,ncol=3)
m2[,1]<-runif(100,max=(max(sub$long,na.rm=T)+.00000001),min = (min(sub$long,na.rm=T)-.00000001))
m2[,2]<-runif(100,max=(max(sub$lat,na.rm=T)+.00000001),min = (min(sub$lat,na.rm=T)-.00000001))
m2[,3]<-point.in.polygon(m2[,1],m2[,2],sub$long,sub$lat)
m2<-subset(m2, m2[,3]>0)
m1<-rbind(m1,m2)
m1<-unique(m1)
}
m1<-m1[1:pops[i,4],]
m_final<-rbind(m_final,m1)
}
m_final<-matrix(nrow=0,ncol=3)
for (i in 1:nrow(good_good2)){
sub<-good_good2[(1+(5*(i-1))):(5*i),]
m1<-matrix(nrow=0,ncol=3)
while(nrow(m1) < pops[i,4]) {
m2<-matrix(nrow=100,ncol=3)
m2[,1]<-runif(100,max=(max(sub$long,na.rm=T)+.00000001),min = (min(sub$long,na.rm=T)-.00000001))
m2[,2]<-runif(100,max=(max(sub$lat,na.rm=T)+.00000001),min = (min(sub$lat,na.rm=T)-.00000001))
m2[,3]<-point.in.polygon(m2[,1],m2[,2],sub$long,sub$lat)
m2<-subset(m2, m2[,3]>0)
m1<-rbind(m1,m2)
m1<-unique(m1)
}
m1<-m1[1:pops$pop2010[i],]
m_final<-rbind(m_final,m1)
}
pops<-good_good2[,c(6,10:16)]
pops[,c(2:8)]<-pops[,c(2:8)]/5
pops<-aggregate(.~id,pops,FUN=sum)
pops$id<-as.numeric(pops$id)
row.names(pops)<-pops$id
pops[,c(2:8)]<-round(pops[,c(2:8)],0)
m_final<-matrix(nrow=0,ncol=3)
for (i in 1:nrow(good_good2)){
sub<-good_good2[(1+(5*(i-1))):(5*i),]
m1<-matrix(nrow=0,ncol=3)
while(nrow(m1) < pops[i,4]) {
m2<-matrix(nrow=100,ncol=3)
m2[,1]<-runif(100,max=(max(sub$long,na.rm=T)+.00000001),min = (min(sub$long,na.rm=T)-.00000001))
m2[,2]<-runif(100,max=(max(sub$lat,na.rm=T)+.00000001),min = (min(sub$lat,na.rm=T)-.00000001))
m2[,3]<-point.in.polygon(m2[,1],m2[,2],sub$long,sub$lat)
m2<-subset(m2, m2[,3]>0)
m1<-rbind(m1,m2)
m1<-unique(m1)
}
m1<-m1[1:pops$pop2010[i],]
m_final<-rbind(m_final,m1)
}
View(m_final)
m_final<-matrix(nrow=0,ncol=3)
for (i in 1:112830){
sub<-good_good2[(1+(5*(i-1))):(5*i),]
m1<-matrix(nrow=0,ncol=3)
while(nrow(m1) < pops[i,4]) {
m2<-matrix(nrow=100,ncol=3)
m2[,1]<-runif(100,max=(max(sub$long,na.rm=T)+.00000001),min = (min(sub$long,na.rm=T)-.00000001))
m2[,2]<-runif(100,max=(max(sub$lat,na.rm=T)+.00000001),min = (min(sub$lat,na.rm=T)-.00000001))
m2[,3]<-point.in.polygon(m2[,1],m2[,2],sub$long,sub$lat)
m2<-subset(m2, m2[,3]>0)
m1<-rbind(m1,m2)
m1<-unique(m1)
}
m1<-m1[1:pops[i,4],]
m_final<-rbind(m_final,m1)
}
View(m_final)
View(pops)
pops<-good_good2[,c(6,10:16)]
pops[,c(2:8)]<-pops[,c(2:8)]/5
pops<-aggregate(.~id,pops,FUN=sum)
pops$id<-as.numeric(pops$id)
pops<-sort(pops$id)
pops<-good_good2[,c(6,10:16)]
pops[,c(2:8)]<-pops[,c(2:8)]/5
pops<-aggregate(.~id,pops,FUN=sum)
pops$id<-as.numeric(pops$id)
pops<-pops[order(id),]
pops<-pops[order(id),]
pops<-pops[order(-id),]
pops<-pops[order(id),]
pops<-pops[order(pops$id),]
row.names(pops)<-pops$id
pop_list<-pops[,4]
pops[,c(2:8)]<-round(pops[,c(2:8)],0)
pop_list<-pops[,4]
m_final<-matrix(nrow=0,ncol=3)
for (i in 1:112830){
sub<-good_good2[(1+(5*(i-1))):(5*i),]
m1<-matrix(nrow=0,ncol=3)
while(nrow(m1) < pop_list[[i]]) {
m2<-matrix(nrow=100,ncol=3)
m2[,1]<-runif(100,max=(max(sub$long,na.rm=T)+.00000001),min = (min(sub$long,na.rm=T)-.00000001))
m2[,2]<-runif(100,max=(max(sub$lat,na.rm=T)+.00000001),min = (min(sub$lat,na.rm=T)-.00000001))
m2[,3]<-point.in.polygon(m2[,1],m2[,2],sub$long,sub$lat)
m2<-subset(m2, m2[,3]>0)
m1<-rbind(m1,m2)
m1<-unique(m1)
}
m1<-m1[1:pop_list[[i]],]
m_final<-rbind(m_final,m1)
}
View(m_final)
