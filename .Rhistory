legend.position = c(.1,.2))+
ggtitle("Clan Pop. (gpw4)")
##
#ggsave("lbr_county.png", arrangeGrob(lbr_county_pop, lbr_county_density,lbr_county_perfem,lbr_county_house, nrow = 2,ncol = 2), width = 14, height = 12, dpi = 150)
comparison<-arrangeGrob(map1,map4,map2,map5,map3,map6,nrow=3,ncol=2)
ggsave("comaprison.png",comparison,width = 20, height = 18, dpi = 150)
##
lbr_0_gpw4<-load("lbr_0_gpw4.RData")
lbr_0_gpw4_totals<-aggregate(.~ID,lbr_0_gpw4,sum)
lbr_0_gpw4_totals$ID<-as.character((lbr_0_gpw4_totals$ID-1))
names(lbr_0_gpw4_totals)[2]<-"pop"
lbr_0_f_gpw4<-left_join(x=lbr_0_f,y=lbr_0_gpw4_totals,by=c("id"="ID"))
#lbr_1_gpw4<-extract(gpw4,lbr_1,df=TRUE)
#save(lbr_1_gpw4,file = "lbr_1_gpw4.RData")
lbr_1_gpw4<-load("lbr_1_gpw4.RData")
lbr_1_gpw4_totals<-aggregate(.~ID,lbr_1_gpw4,sum)
lbr_1_gpw4_totals$ID<-as.character((lbr_1_gpw4_totals$ID-1))
names(lbr_1_gpw4_totals)[2]<-"pop"
lbr_1_f_gpw4<-left_join(x=lbr_1_f,y=lbr_1_gpw4_totals,by=c("id"="ID"))
#lbr_2_gpw4<-extract(gpw4,lbr_2,df=TRUE)
#save(lbr_2_gpw4,file = "lbr_2_gpw4.RData")
lbr_2_gpw4<-load("lbr_2_gpw4.RData")
lbr_2_gpw4_totals<-aggregate(.~ID,lbr_2_gpw4,sum)
lbr_2_gpw4_totals$ID<-as.character((lbr_2_gpw4_totals$ID-1))
names(lbr_2_gpw4_totals)[2]<-"pop"
lbr_2_f_gpw4<-left_join(x=lbr_2_f,y=lbr_2_gpw4_totals,by=c("id"="ID"))
#lbr_3_gpw4<-extract(gpw4,lbr_3,df=TRUE)
#save(lbr_3_gpw4,file = "lbr_3_gpw4.RData")
lbr_3_gpw4<-load("lbr_3_gpw4.RData")
lbr_3_gpw4_totals<-aggregate(.~ID,lbr_3_gpw4,sum)
lbr_3_gpw4_totals$ID<-as.character((lbr_3_gpw4_totals$ID-1))
names(lbr_3_gpw4_totals)[2]<-"pop"
lbr_3_f_gpw4<-left_join(x=lbr_3_f,y=lbr_3_gpw4_totals,by=c("id"="ID"))
### MAKE MAPS ###
map0<-ggplot(lbr_0_f_gpw4, aes(x=long, y = lat))+
geom_map(data = lbr_0_f_gpw4, map=lbr_0_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
scale_fill_gradient(low="yellow",high="red",space="Lab")
# map1<-ggplot(lbr_1_f_gpw4, aes(x=long, y = lat))+
#   geom_map(data = lbr_1_f_gpw4, map=lbr_1_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
#   scale_fill_gradient(low="yellow",high="red",space="Lab")
# map1
map1<-ggplot()+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id,fill=log(pop)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("County Pop. (gpw4)")
# map2<-ggplot(lbr_2_f_gpw4, aes(x=long, y = lat))+
#   geom_map(data = lbr_2_f_gpw4, map=lbr_2_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
#   scale_fill_gradient(low="yellow",high="red",space="Lab")
# map2
map2<-ggplot()+
geom_map(data=lbr_2_f_gpw4,map=lbr_2_f_gpw4,aes(x=long,y=lat,map_id=id,fill=log(pop)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("District Pop. (gpw4)")
map3<-ggplot(lbr_3_f_gpw4, aes(x=long, y = lat))+
geom_map(data = lbr_3_f_gpw4, map=lbr_3_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
scale_fill_gradient(low="yellow",high="red",space="Lab")
map3
map3<-ggplot()+
geom_map(data=lbr_3_f_gpw4,map=lbr_3_f_gpw4,aes(x=long,y=lat,map_id=id,fill=log(pop)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("Clan Pop. (gpw4)")
##
#ggsave("lbr_county.png", arrangeGrob(lbr_county_pop, lbr_county_density,lbr_county_perfem,lbr_county_house, nrow = 2,ncol = 2), width = 14, height = 12, dpi = 150)
comparison<-arrangeGrob(map1,map4,map2,map5,map3,map6,nrow=3,ncol=2)
ggsave("comaprison.png",comparison,width = 20, height = 18, dpi = 150)
##
lbr_0_gpw4<-load("lbr_0_gpw4.RData")
lbr_0_gpw4_totals<-aggregate(.~ID,lbr_0_gpw4,sum)
View(lbr_0_gwp4)
lbr_0_gpw4<-extract(gpw4,lbr_0,df=TRUE)
lbr_0_gpw4_totals<-aggregate(.~ID,lbr_0_gpw4,sum)
View(lbr_0_gpw4)
lbr_0_gpw4<-load("lbr_0_gpw4.RData")
lbr_0_gpw4<-extract(gpw4,lbr_0,df=TRUE)
save(lbr_0_gpw4,file = "lbr_0_gpw4.RData")
lbr_0_gpw4_totals<-aggregate(.~ID,lbr_0_gpw4,sum)
lbr_0_gpw4<-load("lbr_0_gpw4.RData")
load("lbr_0_gpw4.RData")
lbr_0_gpw4_totals<-aggregate(.~ID,lbr_0_gpw4,sum)
#lbr_0_gpw4<-extract(gpw4,lbr_0,df=TRUE)
#save(lbr_0_gpw4,file = "lbr_0_gpw4.RData")
load("lbr_0_gpw4.RData")
lbr_0_gpw4_totals<-aggregate(.~ID,lbr_0_gpw4,sum)
lbr_0_gpw4_totals$ID<-as.character((lbr_0_gpw4_totals$ID-1))
names(lbr_0_gpw4_totals)[2]<-"pop"
lbr_0_f_gpw4<-left_join(x=lbr_0_f,y=lbr_0_gpw4_totals,by=c("id"="ID"))
#lbr_1_gpw4<-extract(gpw4,lbr_1,df=TRUE)
#save(lbr_1_gpw4,file = "lbr_1_gpw4.RData")
load("lbr_1_gpw4.RData")
lbr_1_gpw4_totals<-aggregate(.~ID,lbr_1_gpw4,sum)
lbr_1_gpw4_totals$ID<-as.character((lbr_1_gpw4_totals$ID-1))
names(lbr_1_gpw4_totals)[2]<-"pop"
lbr_1_f_gpw4<-left_join(x=lbr_1_f,y=lbr_1_gpw4_totals,by=c("id"="ID"))
#lbr_2_gpw4<-extract(gpw4,lbr_2,df=TRUE)
#save(lbr_2_gpw4,file = "lbr_2_gpw4.RData")
load("lbr_2_gpw4.RData")
lbr_2_gpw4_totals<-aggregate(.~ID,lbr_2_gpw4,sum)
lbr_2_gpw4_totals$ID<-as.character((lbr_2_gpw4_totals$ID-1))
names(lbr_2_gpw4_totals)[2]<-"pop"
lbr_2_f_gpw4<-left_join(x=lbr_2_f,y=lbr_2_gpw4_totals,by=c("id"="ID"))
#lbr_3_gpw4<-extract(gpw4,lbr_3,df=TRUE)
#save(lbr_3_gpw4,file = "lbr_3_gpw4.RData")
load("lbr_3_gpw4.RData")
lbr_3_gpw4_totals<-aggregate(.~ID,lbr_3_gpw4,sum)
lbr_3_gpw4_totals$ID<-as.character((lbr_3_gpw4_totals$ID-1))
names(lbr_3_gpw4_totals)[2]<-"pop"
lbr_3_f_gpw4<-left_join(x=lbr_3_f,y=lbr_3_gpw4_totals,by=c("id"="ID"))
### MAKE MAPS ###
map0<-ggplot(lbr_0_f_gpw4, aes(x=long, y = lat))+
geom_map(data = lbr_0_f_gpw4, map=lbr_0_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
scale_fill_gradient(low="yellow",high="red",space="Lab")
# map1<-ggplot(lbr_1_f_gpw4, aes(x=long, y = lat))+
#   geom_map(data = lbr_1_f_gpw4, map=lbr_1_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
#   scale_fill_gradient(low="yellow",high="red",space="Lab")
# map1
map1<-ggplot()+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id,fill=log(pop)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("County Pop. (gpw4)")
# map2<-ggplot(lbr_2_f_gpw4, aes(x=long, y = lat))+
#   geom_map(data = lbr_2_f_gpw4, map=lbr_2_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
#   scale_fill_gradient(low="yellow",high="red",space="Lab")
# map2
map2<-ggplot()+
geom_map(data=lbr_2_f_gpw4,map=lbr_2_f_gpw4,aes(x=long,y=lat,map_id=id,fill=log(pop)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("District Pop. (gpw4)")
map3<-ggplot(lbr_3_f_gpw4, aes(x=long, y = lat))+
geom_map(data = lbr_3_f_gpw4, map=lbr_3_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
scale_fill_gradient(low="yellow",high="red",space="Lab")
map3
map3<-ggplot()+
geom_map(data=lbr_3_f_gpw4,map=lbr_3_f_gpw4,aes(x=long,y=lat,map_id=id,fill=log(pop)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("Clan Pop. (gpw4)")
##
#ggsave("lbr_county.png", arrangeGrob(lbr_county_pop, lbr_county_density,lbr_county_perfem,lbr_county_house, nrow = 2,ncol = 2), width = 14, height = 12, dpi = 150)
comparison<-arrangeGrob(map1,map4,map2,map5,map3,map6,nrow=3,ncol=2)
ggsave("comaprison.png",comparison,width = 20, height = 18, dpi = 150)
##
lbr_0_gpw4<-extract(gpw4,lbr_0,df=TRUE)
save(lbr_0_gpw4,file = "lbr_0_gpw4.RData")
rm(lbr_0_gpw4)
load("lbr_0_gpw4.RData")
lbr_0_gpw4_totals<-aggregate(.~ID,lbr_0_gpw4,sum)
lbr_1_gpw4<-extract(gpw4,lbr_1,df=TRUE)
save(lbr_1_gpw4,file = "lbr_1_gpw4.RData")
lbr_2_gpw4<-extract(gpw4,lbr_2,df=TRUE)
save(lbr_2_gpw4,file = "lbr_2_gpw4.RData")
lbr_3_gpw4<-extract(gpw4,lbr_3,df=TRUE)
save(lbr_3_gpw4,file = "lbr_3_gpw4.RData")
rm(list=ls())
setwd("~/GitHub/Liberia")
#### IMPORT SHAPEFILES ####
lbr_0<-readOGR(dsn="shapefiles", layer="liberia_revised",stringsAsFactors=FALSE, verbose=FALSE)
lbr_1<-readOGR(dsn = "shapefiles",layer="counties",stringsAsFactors = FALSE,verbose=FALSE)
lbr_2<-readOGR(dsn="shapefiles",layer="districts", stringsAsFactors = FALSE,verbose = FALSE)
lbr_3<-readOGR(dsn="shapefiles",layer="clans", stringsAsFactors = FALSE,verbose = FALSE)
proj4string(lbr_0)
proj4string(lbr_1)
proj4string(lbr_2)
proj4string(lbr_3)
lbr_0<-spTransform(lbr_0, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
lbr_1<-spTransform(lbr_1, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
lbr_2<-spTransform(lbr_2, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
lbr_3<-spTransform(lbr_3, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
### FORTIFY ###
lbr_0_f<-fortify(lbr_0)
lbr_1_f<-fortify(lbr_1)
lbr_2_f<-fortify(lbr_2)
lbr_3_f<-fortify(lbr_3)
##
#### V1. SHAPEFILES DATA ####
### CORRECT DATA ###
lbr_1@data$SUM_HH[1]<-20508
lbr_2@data[which(lbr_2@data$FIRST_CCNA=="Bomi"),]$HHOLDS<-lbr_2@data[which(lbr_2@data$FIRST_CCNA=="Bomi"),]$TOTAL/(lbr_1@data$SUM_TOTAL[1]/lbr_1@data$SUM_HH[1])
lbr_3@data[which(lbr_3@data$FIRST_CCNA=="Bomi"),]$SUM_HH<-lbr_3@data[which(lbr_3@data$FIRST_CCNA=="Bomi"),]$SUM_TOTAL/(lbr_1@data$SUM_TOTAL[1]/lbr_1@data$SUM_HH[1])
lbr_3@data[which(lbr_3@data$FIRST_CCNA=="River Gee"),]$SUM_HH[29]<-lbr_3@data[which(lbr_3@data$FIRST_CCNA=="River Gee"),]$SUM_TOTAL[29]/mean(lbr_3@data[which(lbr_3@data$FIRST_CCNA=="River Gee"),]$SUM_TOTAL[c(1:28,30:45)]/lbr_3@data[which(lbr_3@data$FIRST_CCNA=="River Gee"),]$SUM_HH[c(1:28,30:45)])
### MERGE DATA ###
lbr_1@data$ID<-as.character(c(0:14))
lbr_1_f_shp<-left_join(x=lbr_1_f,y=lbr_1@data,by=c("id"="ID"))
lbr_2@data$ID<-as.character(c(0:135))
lbr_2_f_shp<-left_join(x=lbr_2_f,y=lbr_2@data,by=c("id"="ID"))
lbr_3@data$ID<-as.character(c(0:815))
lbr_3_f_shp<-left_join(x=lbr_3_f,y=lbr_3@data,by=c("id"="ID"))
# ### ADJUST LABELS ###
# ct_points<-gCentroid(counties,byid=TRUE)
# county_labels<-cbind.data.frame(counties@data$CCNAME,ct_points@coords[,1],ct_points@coords[,2])
# colnames(county_labels)<-c("name","x","y")
# county_labels[9,2]<--10.2
# county_labels[9,3]<-6.63
# ct_points_2<-gCentroid(districts,byid=TRUE)
# district_labels<-cbind.data.frame(districts@data$DNAME,ct_points_2@coords[,1],ct_points_2@coords[,2])
# colnames(district_labels)<-c("name","x","y")
# ct_points_3<-gCentroid(clans,byid=TRUE)
# clan_labels<-cbind.data.frame(clans@data$CLNAME,clans@data$FIRST_DNAM,ct_points_3@coords[,1],ct_points_3@coords[,2])
# colnames(clan_labels)<-c("name","district","x","y")
# clan_labels2<-clan_labels
# n<-nrow(clan_labels[which(clan_labels$district=="Greater Monrovia"),])
# remove<-vector("list",length=n)
# clan_labels[which(clan_labels$dist == "Greater Monrovia"),]$name <- remove
# m<-nrow(clan_labels[which(clan_labels$dist=="Commonwealth"),])
# remove2<-vector("list",m)
# clan_labels[which(clan_labels$dist == "Commonwealth"),]$name <- remove2
### MAKE MAPS ###
map4<-ggplot()+
geom_map(data=lbr_1_f_shp,map=lbr_1_f_shp,aes(x=long,y=lat,map_id=id,fill=log(SUM_TOTAL)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_shp,map=lbr_1_f_shp,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.2)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("County Pop. (Shapefile)")
map5<-ggplot()+
geom_map(data=lbr_2_f_shp,map=lbr_2_f_shp,aes(x=long,y=lat,map_id=id,fill=log(TOTAL)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_shp,map=lbr_1_f_shp,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("District Pop. (Shapefile))")
map6<-ggplot()+
geom_map(data=lbr_3_f_shp,map=lbr_3_f_shp,aes(x=long,y=lat,map_id=id,fill=log(SUM_TOTAL)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_shp,map=lbr_1_f_shp,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("Clan Pop. (Shapefile)")
##
#### V2. GPW4 ####
### LOAD GWP4 DATA ###
#gpw4<-raster("~/Documents/W_M/Year_1/2017_Summer/Monroe_Project/gpw-v4-population-count_2010.tif")
#gpw4
#plot(gpw4)
### JOIN DATA ###
#lbr_0_gpw4<-extract(gpw4,lbr_0,df=TRUE)
#save(lbr_0_gpw4,file = "lbr_0_gpw4.RData")
load("lbr_0_gpw4.RData")
lbr_0_gpw4_totals<-aggregate(.~ID,lbr_0_gpw4,sum)
lbr_0_gpw4_totals$ID<-as.character((lbr_0_gpw4_totals$ID-1))
names(lbr_0_gpw4_totals)[2]<-"pop"
lbr_0_f_gpw4<-left_join(x=lbr_0_f,y=lbr_0_gpw4_totals,by=c("id"="ID"))
#lbr_1_gpw4<-extract(gpw4,lbr_1,df=TRUE)
#save(lbr_1_gpw4,file = "lbr_1_gpw4.RData")
load("lbr_1_gpw4.RData")
lbr_1_gpw4_totals<-aggregate(.~ID,lbr_1_gpw4,sum)
lbr_1_gpw4_totals$ID<-as.character((lbr_1_gpw4_totals$ID-1))
names(lbr_1_gpw4_totals)[2]<-"pop"
lbr_1_f_gpw4<-left_join(x=lbr_1_f,y=lbr_1_gpw4_totals,by=c("id"="ID"))
#lbr_2_gpw4<-extract(gpw4,lbr_2,df=TRUE)
#save(lbr_2_gpw4,file = "lbr_2_gpw4.RData")
load("lbr_2_gpw4.RData")
lbr_2_gpw4_totals<-aggregate(.~ID,lbr_2_gpw4,sum)
lbr_2_gpw4_totals$ID<-as.character((lbr_2_gpw4_totals$ID-1))
names(lbr_2_gpw4_totals)[2]<-"pop"
lbr_2_f_gpw4<-left_join(x=lbr_2_f,y=lbr_2_gpw4_totals,by=c("id"="ID"))
#lbr_3_gpw4<-extract(gpw4,lbr_3,df=TRUE)
#save(lbr_3_gpw4,file = "lbr_3_gpw4.RData")
load("lbr_3_gpw4.RData")
lbr_3_gpw4_totals<-aggregate(.~ID,lbr_3_gpw4,sum)
lbr_3_gpw4_totals$ID<-as.character((lbr_3_gpw4_totals$ID-1))
names(lbr_3_gpw4_totals)[2]<-"pop"
lbr_3_f_gpw4<-left_join(x=lbr_3_f,y=lbr_3_gpw4_totals,by=c("id"="ID"))
### MAKE MAPS ###
map0<-ggplot(lbr_0_f_gpw4, aes(x=long, y = lat))+
geom_map(data = lbr_0_f_gpw4, map=lbr_0_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
scale_fill_gradient(low="yellow",high="red",space="Lab")
# map1<-ggplot(lbr_1_f_gpw4, aes(x=long, y = lat))+
#   geom_map(data = lbr_1_f_gpw4, map=lbr_1_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
#   scale_fill_gradient(low="yellow",high="red",space="Lab")
# map1
map1<-ggplot()+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id,fill=log(pop)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("County Pop. (gpw4)")
# map2<-ggplot(lbr_2_f_gpw4, aes(x=long, y = lat))+
#   geom_map(data = lbr_2_f_gpw4, map=lbr_2_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
#   scale_fill_gradient(low="yellow",high="red",space="Lab")
# map2
map2<-ggplot()+
geom_map(data=lbr_2_f_gpw4,map=lbr_2_f_gpw4,aes(x=long,y=lat,map_id=id,fill=log(pop)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("District Pop. (gpw4)")
map3<-ggplot(lbr_3_f_gpw4, aes(x=long, y = lat))+
geom_map(data = lbr_3_f_gpw4, map=lbr_3_f_gpw4,aes(x=long, y=lat,map_id=id,fill=pop))+
scale_fill_gradient(low="yellow",high="red",space="Lab")
map3
map3<-ggplot()+
geom_map(data=lbr_3_f_gpw4,map=lbr_3_f_gpw4,aes(x=long,y=lat,map_id=id,fill=log(pop)))+
scale_fill_gradientn(colours = c("grey100","red2"),guide=guide_colourbar(title=NULL),space="Lab",na.value = "grey60")+
geom_map(data=lbr_1_f_gpw4,map=lbr_1_f_gpw4,aes(x=long,y=lat,map_id=id),color="grey45",alpha=0,size=.1)+
theme(text = element_text(color = "white"),
rect = element_rect(fill = "grey35", color = "grey35"),
plot.background = element_rect(fill = "grey35", color = "grey35"),
panel.background = element_rect(fill = "grey35", color = "grey35"),
plot.title = element_text(),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.position = c(.1,.2))+
ggtitle("Clan Pop. (gpw4)")
##
#ggsave("lbr_county.png", arrangeGrob(lbr_county_pop, lbr_county_density,lbr_county_perfem,lbr_county_house, nrow = 2,ncol = 2), width = 14, height = 12, dpi = 150)
comparison<-arrangeGrob(map1,map4,map2,map5,map3,map6,nrow=3,ncol=2)
ggsave("comaprison.png",comparison,width = 20, height = 18, dpi = 150)
##
ggsave("comparison.png",comparison,width = 20, height = 18, dpi = 150)
ggsave("comparison.png",comparison,width = 20, height = 18, dpi = 150)
load("cwiq10.RData")
View(cwiq10)
View(lbr_3_f)
View(lbr_3_f_shp)
unique(lbr_3@data$FIRST_CLCO)
y<-unique(lbr_3@data$FIRST_CLCO)
z<-unique(cwiq10$clan_town)
lbr_3_names <- lbr_3@data$CLNAME
lbr_3_cpts <- gCentroid(lbr_3, byid=TRUE)
lbr_3_labs <- cbind.data.frame(lbr_3_names, lbr_3_cpts@coords[,1], lbr_3_cpts@coords[,2])
names(lbr_3_labs) <- c("lbr_3","x","y")
lbr_3_survey_cpts <- cbind.data.frame(county_id = lbr_3@data$FIRST_CCOD, district_id = lbr_3@data$FIRST_DCOD, clan_id = lbr_3@data$FIRST_CLCO, lbr_3_labs)
cwiq10$clan_town <- substr(cwiq10$hid_mungai,5,7)
lbr_3_survey_cpts$clan_code  <- paste(lbr_3_survey_cpts$county_id, lbr_3_survey_cpts$district_id, lbr_3_survey_cpts$clan_id, sep = "")
cwiq10$clan_town_code <- paste(cwiq10$county, cwiq10$district, cwiq10$clan_town, sep= "")
lbr_3_cwiq10 <- left_join(x = lbr_3_survey_cpts, y = cwiq10, by = c("clan_code" = "clan_town_code"))
View(lbr_3_cwiq10)
View(lbr_3_labs)
View(lbr_3_survey_cpts)
lbr_3_names <- lbr_3@data$CLNAME
lbr_3_cpts <- gCentroid(lbr_3, byid=TRUE)
lbr_3_labs <- cbind.data.frame(lbr_3_names, lbr_3_cpts@coords[,1], lbr_3_cpts@coords[,2])
names(lbr_3_labs) <- c("clans","x","y")
lbr_3_survey_cpts <- cbind.data.frame(county_id = lbr_3@data$FIRST_CCOD, district_id = lbr_3@data$FIRST_DCOD, clan_id = lbr_3@data$FIRST_CLCO, lbr_3_labs)
cwiq10$clan_town <- substr(cwiq10$hid_mungai,5,7)
lbr_3_survey_cpts$clan_code  <- paste(lbr_3_survey_cpts$county_id, lbr_3_survey_cpts$district_id, lbr_3_survey_cpts$clan_id, sep = "")
cwiq10$clan_town_code <- paste(cwiq10$county, cwiq10$district, cwiq10$clan_town, sep= "")
lbr_3_cwiq10 <- left_join(x = lbr_3_survey_cpts, y = cwiq10, by = c("clan_code" = "clan_town_code"))
View(lbr_3_survey_cpts)
cwiq10$clan_town <- substr(cwiq10$hid_mungai,5,7)
View(cwiq10)
cwiq10$county <- substr(cwiq10$hid_mungai,1,2)
cwiq10$county[cwiq10$county == "01"] <- "30"
cwiq10$district <- substr(cwiq10$hid_mungai,3,4)
lbr_3_survey_cpts$clan_code  <- paste(lbr_3_survey_cpts$county_id, lbr_3_survey_cpts$district_id, lbr_3_survey_cpts$clan_id, sep = "")
cwiq10$clan_town_code <- paste(cwiq10$county, cwiq10$district, cwiq10$clan_town, sep= "")
lbr_3_cwiq10 <- left_join(x = lbr_3_survey_cpts, y = cwiq10, by = c("clan_code" = "clan_town_code"))
View(lbr_3_cwiq10)
x<-sum(lbr_3_cwiq10$wta_hh,na.rm=T)
823000*5
823000*4.98
a<-unique(lbr_3_cwiq10$clans)
a
b<-subset(a, !(a %in% lbr_3@data$CLNAME))
b<-subset(a, (a %in% lbr_3@data$CLNAME))
b<-subset(a, !(a %in% lbr_3@data$CLNAME))
lbr_3@data$CLNAME
lbr_3@polygons[319]
test<-aggregate(wt_hh ~ clans, lbr_3_cwiq10, sum)
test<-aggregate(wta_hh ~ clans, lbr_3_cwiq10, sum)
View(test)
test<-aggregate(wta_hh ~ clan_id, lbr_3_cwiq10, sum)
test<-aggregate(wta_hh ~ clans, lbr_3_cwiq10, sum)
test<-aggregate(wta_hh ~ clan_code, lbr_3_cwiq10, sum)
test<-aggregate(wta_hh ~ clans, lbr_3_cwiq10, sum)
test<-aggregate(wta_hh ~ clans, lbr_3_cwiq10, sum)
unique(lbr_3$CLNAME)
test2<-subset(lbr_3_cwiq10, is.na(lbr_3_cwiq10$wta_hh))
View(test2)
unique(lbr_3_cwiq10$district_id)
lbr_3_cwiq10$dist_code<-paste(lbr_3_cwiq10$county_id,lbr_3_cwiq10$district_id)
View(lbr_3_cwiq10)
test<-aggregate(wta_hh ~ dist_code, lbr_3_cwiq10, sum)
test<-aggregate(wta_hh ~ county_id, lbr_3_cwiq10, sum)
View(test)
lbr_3$FIRST_CCOD
unique(lbr_3$FIRST_CCOD)
View(lbr_3_f_shp)
runif(100000)
win<-as(lbr_3_f_shp[which(lbr_3_f_shp$FIRST_CCOD==18)][,c(1:2)],owin)
win<-as(lbr_3_f_shp[which(lbr_3_f_shp$FIRST_CCOD==18),][,c(1:2)],owin)
win<-as(lbr_3_f_shp[which(lbr_3_f_shp$FIRST_CCOD==18),],owin)
win<-as(lbr_1@polygons[1],owin)
win<-as(lbr_1@polygons[1],"owin")
lbr_1@polygons[0]
lbr_1@polygons[1]
win<-as(lbr_1@polygons[1]@coords,"owin")
win<-as(lbr_1@polygons@coords,"owin")
win<-as(lbr_1@coords,"owin")
win<-as(lbr_1@polygons$@coords,"owin")
win<-as(lbr_1@polygons[[1]]@Polygons[[1]]@coords,"owin")
