rand_num<-sample(1:100,36,replace=T)
win_list<-list()
for (i in 0:5) {
win1<-owin(xrange=c(i,i+1),yrange=c(0,1))
win2<-owin(xrange=c(i,i+1),yrange=c(1,2))
win3<-owin(xrange=c(i,i+1),yrange=c(2,3))
win4<-owin(xrange=c(i,i+1),yrange=c(3,4))
win5<-owin(xrange=c(i,i+1),yrange=c(4,5))
win6<-owin(xrange=c(i,i+1),yrange=c(5,6))
win_list<-c(win_list,list(win1,win2,win3,win4,win5,win6))
}
ppp_list<-lapply(1:36,function(i) rpoint(rand_num[[i]],win=win_list[[i]]))
ppp_list<-as.solist(ppp_list)
ppp_total<-superimpose(ppp_list,W=tess(tiles=win_list))
plot(ppp_total)
dens2<-density(ppp_total,sigma=bw.ppl)
bw.ppl(ppp_total)
summary(dens2)
plot(dens2)
plot(quadratcount(ppp_total,nx=6,ny=6))
dens3<-density(ppp_total,eps=.5)
summary(dens3)
plot(dens3)
plot(quadratcount(ppp_total,nx=12,ny=12))
dens1<-density(ppp_total,eps=.1)
summary(dens1)
plot(dens1)
plot(quadratcount(ppp_total,nx=60,ny=60))
rm(list=ls())
setwd("~/GitHub/Liberia")
quartz()
par(mfrow=c(3,2))
rand_num<-sample(1:100,36,replace=T)
win_list<-list()
for (i in 0:5) {
win1<-owin(xrange=c(i,i+1),yrange=c(0,1))
win2<-owin(xrange=c(i,i+1),yrange=c(1,2))
win3<-owin(xrange=c(i,i+1),yrange=c(2,3))
win4<-owin(xrange=c(i,i+1),yrange=c(3,4))
win5<-owin(xrange=c(i,i+1),yrange=c(4,5))
win6<-owin(xrange=c(i,i+1),yrange=c(5,6))
win_list<-c(win_list,list(win1,win2,win3,win4,win5,win6))
}
ppp_list<-lapply(1:36,function(i) rpoint(rand_num[[i]],win=win_list[[i]]))
ppp_list<-as.solist(ppp_list)
ppp_total<-superimpose(ppp_list,W=tess(tiles=win_list))
plot(ppp_total)
dens2<-density(ppp_total,sigma=bw.ppl)
bw.ppl(ppp_total)
summary(dens2)
plot(dens2)
plot(quadratcount(ppp_total,nx=6,ny=6))
dens3<-density(ppp_total,eps=.5)
summary(dens3)
plot(dens3)
plot(quadratcount(ppp_total,nx=12,ny=12))
dens1<-density(ppp_total,eps=.1)
summary(dens1)
plot(dens1)
plot(quadratcount(ppp_total,nx=60,ny=60))
ppp_total<-superimpose(ppp_list,W=tess(tiles=win_list))
dens2<-density(ppp_total,sigma=bw.ppl)
bw.ppl(ppp_total)
summary(dens2)
plot(dens2)
plot(quadratcount(ppp_total,nx=6,ny=6))
dens3<-density(ppp_total,eps=.5)
summary(dens3)
plot(dens3)
plot(quadratcount(ppp_total,nx=12,ny=12))
dens1<-density(ppp_total,eps=.1)
summary(dens1)
plot(dens1)
plot(quadratcount(ppp_total,nx=60,ny=60))
plot.new()
par(mfrow=c(3,2))
rand_num<-sample(1:100,36,replace=T)
win_list<-list()
for (i in 0:5) {
win1<-owin(xrange=c(i,i+1),yrange=c(0,1))
win2<-owin(xrange=c(i,i+1),yrange=c(1,2))
win3<-owin(xrange=c(i,i+1),yrange=c(2,3))
win4<-owin(xrange=c(i,i+1),yrange=c(3,4))
win5<-owin(xrange=c(i,i+1),yrange=c(4,5))
win6<-owin(xrange=c(i,i+1),yrange=c(5,6))
win_list<-c(win_list,list(win1,win2,win3,win4,win5,win6))
}
ppp_list<-lapply(1:36,function(i) rpoint(rand_num[[i]],win=win_list[[i]]))
ppp_list<-as.solist(ppp_list)
ppp_total<-superimpose(ppp_list,W=tess(tiles=win_list))
dens2<-density(ppp_total,sigma=bw.ppl)
bw.ppl(ppp_total)
summary(dens2)
plot(dens2)
plot(quadratcount(ppp_total,nx=6,ny=6))
dens3<-density(ppp_total,eps=.5)
summary(dens3)
plot(dens3)
plot(quadratcount(ppp_total,nx=12,ny=12))
dens1<-density(ppp_total,eps=.1)
summary(dens1)
plot(dens1)
plot(quadratcount(ppp_total,nx=60,ny=60))
intens<-intesity(ppp_total)
intens<-intensity(ppp_total)
intens<-intensity(ppp_total,image=T)
plot(intens)
intens<-intensity(quadratcount(ppp_total),image=T)
plot(intens)
plot.new()
quartz()
plot.new()
par(mfrow=c(2,3))
rand_num<-sample(1:100,36,replace=T)
win_list<-list()
for (i in 0:5) {
win1<-owin(xrange=c(i,i+1),yrange=c(0,1))
win2<-owin(xrange=c(i,i+1),yrange=c(1,2))
win3<-owin(xrange=c(i,i+1),yrange=c(2,3))
win4<-owin(xrange=c(i,i+1),yrange=c(3,4))
win5<-owin(xrange=c(i,i+1),yrange=c(4,5))
win6<-owin(xrange=c(i,i+1),yrange=c(5,6))
win_list<-c(win_list,list(win1,win2,win3,win4,win5,win6))
}
ppp_list<-lapply(1:36,function(i) rpoint(rand_num[[i]],win=win_list[[i]]))
ppp_list<-as.solist(ppp_list)
ppp_total<-superimpose(ppp_list,W=tess(tiles=win_list))
dens1<-density(ppp_total)
summary(dens1)
plot(dens1)
plot(quadratcount(ppp_total))
intens<-intensity(quadratcount(ppp_total),image=T)
plot(intens)
dens1<-density(ppp_total,eps=1)
summary(dens1)
plot(dens1)
plot(quadratcount(ppp_total,nx=6,ny=6))
intens<-intensity(quadratcount(ppp_total),image=T)
plot(intens)
dens1<-density(ppp_total,eps=1)
summary(dens1)
plot(dens1)
plot(quadratcount(ppp_total,nx=6,ny=6))
intens<-intensity(quadratcount(ppp_total,nx=6,ny=6),image=T)
plot(intens)
plot.new()
plot.new()
par(mfrow=c(1,3))
quartz()
plot.new()
par(mfrow=c(1,3))
rand_num<-sample(1:100,36,replace=T)
win_list<-list()
for (i in 0:5) {
win1<-owin(xrange=c(i,i+1),yrange=c(0,1))
win2<-owin(xrange=c(i,i+1),yrange=c(1,2))
win3<-owin(xrange=c(i,i+1),yrange=c(2,3))
win4<-owin(xrange=c(i,i+1),yrange=c(3,4))
win5<-owin(xrange=c(i,i+1),yrange=c(4,5))
win6<-owin(xrange=c(i,i+1),yrange=c(5,6))
win_list<-c(win_list,list(win1,win2,win3,win4,win5,win6))
}
ppp_list<-lapply(1:36,function(i) rpoint(rand_num[[i]],win=win_list[[i]]))
ppp_list<-as.solist(ppp_list)
ppp_total<-superimpose(ppp_list,W=tess(tiles=win_list))
dens1<-density(ppp_total,eps=1)
summary(dens1)
plot(dens1)
plot(quadratcount(ppp_total,nx=6,ny=6))
intens<-intensity(quadratcount(ppp_total,nx=6,ny=6),image=T)
plot(intens)
den[ppp_total]
dens1[ppp_total]
summary(dens1)
dens1[ppp_total]
dens1<-density(ppp_total,eps=.5)
dens1<-density(ppp_total,eps=.01)
dens1[ppp_total]
rm(list=ls())
setwd("~/GitHub/Liberia")
quartz()
library(rgdal)
library(dplyr)
library(rgeos)
library(ggmap)
library(raster)
library(spatstat)
library(maptools)
library(sp)
library(foreign)
library(knitr)
library(gridExtra)
library(rasterVis)
library(colorspace)
library(mapdata)
library(rgl)
library(scales)
library(plot3Drgl)
library(akima)
win_list<-list()
for (i  in 0:5 ) {
for (j in 0:5){
win<-owin(xrange=c(i,i+1),yrange=c(j,j+1))
win_list<-c(win_list,win)
}
}
win_list<-list()
for (i  in 0:5 ) {
for (j in 0:5){
win<-owin(xrange=c(i,i+1),yrange=c(j,j+1))
win_list<-c(win_list,list(win))
}
}
rand_num<-sample(1:100,36,replace=T)
win_list<-list()
for (i  in 0:5 ) {
for (j in 0:5){
win<-owin(xrange=c(i,i+1),yrange=c(j,j+1))
win_list<-c(win_list,list(win))
}
}
ppp_list<-lapply(1:36,function(i) rpoint(rand_num[[i]],win=win_list[[i]]))
ppp_list<-as.solist(ppp_list)
ppp_total<-superimpose(ppp_list,W=tess(tiles=win_list))
pixellate(ppp_total)
x<-pixellate(ppp_total)
plot(x)
x<-pixellate(ppp_total,eps=.001)
plot(x)
x<-pixellate(ppp_total,eps=.01)
plot(x)
x<-pixellate(ppp_total,eps=1)
plot(x)
plot(quadratcount(ppp_total,nx=6,ny=6))
plot.new()
par(mfrow=c(1,3))
rand_num<-sample(1:100,36,replace=T)
win_list<-list()
for (i  in 0:5 ) {
for (j in 0:5){
win<-owin(xrange=c(i,i+1),yrange=c(j,j+1))
win_list<-c(win_list,list(win))
}
}
ppp_list<-lapply(1:36,function(i) rpoint(rand_num[[i]],win=win_list[[i]]))
ppp_list<-as.solist(ppp_list)
ppp_total<-superimpose(ppp_list,W=tess(tiles=win_list))
x<-pixellate(ppp_total,eps=1)
plot(x)
plot(quadratcount(ppp_total,nx=6,ny=6))
intens<-intensity(quadratcount(ppp_total,nx=6,ny=6),image=T)
plot(intens)
x<-as(x,"quadratcount")
plot(density(x))
plot(density.im(x))
plot(pixellate(density(ppp_total)))
plot(pixellate(intensity(ppp_total)))
jorquelleh<-clan[which(clan@data$FIRST_DNAM=="Jorquelleh"),]
country<-readOGR(dsn="shapefiles", layer="liberia_revised",stringsAsFactors=FALSE, verbose=FALSE)
cnty<-readOGR(dsn = "shapefiles",layer="counties",stringsAsFactors = FALSE,verbose=FALSE)
dist<-readOGR(dsn="shapefiles",layer="districts", stringsAsFactors = FALSE,verbose = FALSE)
clan<-readOGR(dsn="shapefiles",layer="clans", stringsAsFactors = FALSE,verbose = FALSE)
country<-spTransform(country, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
cnty<-spTransform(cnty, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
dist<-spTransform(dist, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
clan<-spTransform(clan, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
country_f<-fortify(country)
cnty_f<-fortify(cnty)
dist_f<-fortify(dist)
clan_f<-fortify(clan)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
gpw4_2000<-crop(gpw4_2000,extent(country))
gpw4_2005<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2005.tif")
gpw4_2005<-crop(gpw4_2005,extent(country))
gpw4_2010<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2010.tif")
gpw4_2010<-crop(gpw4_2010,extent(country))
gpw4_2015<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2015.tif")
gpw4_2015<-crop(gpw4_2015,extent(country))
growth_00_05<-overlay(gpw4_2000,gpw4_2005,fun=function(r1,r2){return((r2-r1)/r1)})
growth_05_10<-overlay(gpw4_2005,gpw4_2010,fun=function(r1,r2){return((r2-r1)/r1)})
growth_10_15<-overlay(gpw4_2010,gpw4_2015,fun=function(r1,r2){return((r2-r1)/r1)})
load("lbr_data_final.RData")
load("gpw4_lbr_spdf.RData")
load("complete_data.RData")
load("points_df_10percent.RData")
load("city_points.RData")
point<-data.frame(long=-9.471618,lat=7.001112)
jorquelleh<-clan[which(clan@data$FIRST_DNAM=="Jorquelleh"),]
plot(jorquelleh)
jorquelleh@data$ID<-rep(1,5)
jorquelleh  <- unionSpatialPolygons(jorquelleh,jorquelleh@data$ID)
plot(jorquelleh)
jorquelleh_f<-point.in.polygon(good_good2$long,good_good2$lat,jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,1],jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,2])
jorquelleh_f<-cbind(good_good2,jorquelleh_f)
jorquelleh_f<-subset(jorquelleh_f,jorquelleh_f>0)
ggplot()+geom_map(data=jorquelleh_f,map=jorquelleh_f,aes(x=long,y=lat,map_id=id))+geom_point(data=point,aes(x=long,y=lat))
j_pops<-jorquelleh_f[,c(6,10:16)]
ids<-unique(j_pops$id)
j_pops[,c(2:8)]<-j_pops[,c(2:8)]/5
sum(j_pops$pop2010)
j_pops<-aggregate(.~id,j_pops,FUN=sum)
j_pops$id<-as.numeric(j_pops$id)
j_pops<-j_pops[order(j_pops$id),]
row.names(j_pops)<-j_pops$id
j_pops[,c(2:8)]<-round(j_pops[,c(2:8)],0)
sum(j_pops[,4])
j_sub<-good_good2[good_good2$id %in% ids,]
m_final<-matrix(nrow=0,ncol=3)
for (i in 1:1645){
if (j_pops[i,4] > 0){
sub<-j_sub[(1+(5*(i-1))):(5*i),]
m1<-matrix(nrow=0,ncol=3)
while(nrow(m1) < j_pops[i,4]) {
m2<-matrix(nrow=100,ncol=3)
m2[,1]<-runif(100,max=(max(sub$long,na.rm=T)+.00000001),min = (min(sub$long,na.rm=T)-.00000001))
m2[,2]<-runif(100,max=(max(sub$lat,na.rm=T)+.00000001),min = (min(sub$lat,na.rm=T)-.00000001))
m2[,3]<-point.in.polygon(m2[,1],m2[,2],jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,1],jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,2])
m2<-subset(m2, m2[,3]>0)
m1<-rbind(m1,m2)
m1<-unique(m1)
}
m1<-m1[1:j_pops[i,4],]
m_final<-rbind(m_final,m1)
}
}
jorquelleh_f_points_df<-m_final
save(jorquelleh_f_points_df,file="jorquelleh_f_points_df.RData")
win<- as(jorquelleh,"owin")
ppp_jorquelleh_f<-ppp(m_final[,1],m_final[,2],window=win)
summary(ppp_jorquelleh_f)
plot(ppp_jorquelleh_f,chars=".")
quartz()
plot(ppp_jorquelleh_f,chars=".")
dens_jorquelleh_f<-density(ppp_jorquelleh_f,eps=.008333)
summary(dens_jorquelleh_f)
plot(dens_jorquelleh_f)
x<-pixellate(ppp+jorquelleh_f)
x<-pixellate(ppp_jorquelleh_f)
plot(x)
summary(x)
x<-pixellate(ppp_jorquelleh_f,eps=.008333)
summary(x)
plot(x)
plot(dens_jorquelleh_f)
x<-pixellate(ppp_jorquelleh_f,eps=.008333)
summary(x)
plot(x)
win1<-as(jorquelleh,"owin")
sum(j_pops[,4])
ppp1<-rpoint(80000,win=win1)
win1<-as(jorquelleh,"owin")
ppp1<-rpoint(80000,win=win1)
plot(density(ppp1))
plot(density(ppp1,sigma=.1))
plot(density(ppp1,sigma=.01))
plot(density(ppp1))
dens_jorquelleh_f<-density(ppp_jorquelleh_f,eps=.008333)
summary(dens_jorquelleh_f)
plot(dens_jorquelleh_f)
ppp_jorquelleh_f<-ppp(m_final[,1],m_final[,2],window=win,marks=1)
View(m_final)
ppp_jorquelleh_f<-ppp(m_final[,1],m_final[,2],window=win,marks=m_final[,3])
summary(ppp_jorquelleh_f)
plot(ppp_jorquelleh_f,chars=".")
x<-pixellate(ppp_jorquelleh_f,eps=.008333)
summary(x)
plot(x)
dens_jorquelleh_f<-density(ppp_jorquelleh_f,eps=.008333)
summary(dens_jorquelleh_f)
plot(dens_jorquelleh_f)
load("cwiq10.RData")
rm(list=ls())
setwd("~/GitHub/Liberia")
quartz()
country<-readOGR(dsn="shapefiles", layer="liberia_revised",stringsAsFactors=FALSE, verbose=FALSE)
cnty<-readOGR(dsn = "shapefiles",layer="counties",stringsAsFactors = FALSE,verbose=FALSE)
dist<-readOGR(dsn="shapefiles",layer="districts", stringsAsFactors = FALSE,verbose = FALSE)
clan<-readOGR(dsn="shapefiles",layer="clans", stringsAsFactors = FALSE,verbose = FALSE)
country<-spTransform(country, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
cnty<-spTransform(cnty, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
dist<-spTransform(dist, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
clan<-spTransform(clan, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
country_f<-fortify(country)
cnty_f<-fortify(cnty)
dist_f<-fortify(dist)
clan_f<-fortify(clan)
gpw4_2000<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2000.tif")
gpw4_2000<-crop(gpw4_2000,extent(country))
gpw4_2005<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2005.tif")
gpw4_2005<-crop(gpw4_2005,extent(country))
gpw4_2010<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2010.tif")
gpw4_2010<-crop(gpw4_2010,extent(country))
gpw4_2015<-raster("~/GoogleDrive/LiberiaProject/gpw-v4-population-count_2015.tif")
gpw4_2015<-crop(gpw4_2015,extent(country))
growth_00_05<-overlay(gpw4_2000,gpw4_2005,fun=function(r1,r2){return((r2-r1)/r1)})
growth_05_10<-overlay(gpw4_2005,gpw4_2010,fun=function(r1,r2){return((r2-r1)/r1)})
growth_10_15<-overlay(gpw4_2010,gpw4_2015,fun=function(r1,r2){return((r2-r1)/r1)})
load("lbr_data_final.RData")
load("gpw4_lbr_spdf.RData")
load("complete_data.RData")
load("points_df_10percent.RData")
load("city_points.RData")
load("cwiq10.RData")
cnty_survey_cpts <- cbind.data.frame(county_id = counties@data$FIRST_CCOD, county_labs, stringsAsFactors = FALSE)
dist_survey_cpts <- cbind.data.frame(county_id = districts@data$FIRST_CCOD, district_id = districts@data$FIRST_DCOD, district_labs)
clan_survey_cpts <- cbind.data.frame(county_id = clans@data$FIRST_CCOD, district_id = clans@data$FIRST_DCOD, clan_id = clans@data$FIRST_CLCO, clan_labs)
ppp_jorquelleh_f<-ppp(m_final[,1],m_final[,2],window=win,marks=m_final[,3])
m_final[,3]<-as.numeric(m_final[,3])
jorquelleh<-clan[which(clan@data$FIRST_DNAM=="Jorquelleh"),]
plot(jorquelleh)
jorquelleh@data$ID<-rep(1,5)
jorquelleh  <- unionSpatialPolygons(jorquelleh,jorquelleh@data$ID)
plot(jorquelleh)
jorquelleh_f<-point.in.polygon(good_good2$long,good_good2$lat,jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,1],jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,2])
jorquelleh_f<-cbind(good_good2,jorquelleh_f)
jorquelleh_f<-subset(jorquelleh_f,jorquelleh_f>0)
ggplot()+geom_map(data=jorquelleh_f,map=jorquelleh_f,aes(x=long,y=lat,map_id=id))+geom_point(data=point,aes(x=long,y=lat))
j_pops<-jorquelleh_f[,c(6,10:16)]
ids<-unique(j_pops$id)
j_pops[,c(2:8)]<-j_pops[,c(2:8)]/5
sum(j_pops$pop2010)
j_pops<-aggregate(.~id,j_pops,FUN=sum)
j_pops$id<-as.numeric(j_pops$id)
j_pops<-j_pops[order(j_pops$id),]
row.names(j_pops)<-j_pops$id
j_pops[,c(2:8)]<-round(j_pops[,c(2:8)],0)
sum(j_pops[,4])
j_sub<-good_good2[good_good2$id %in% ids,]
m_final<-matrix(nrow=0,ncol=3)
for (i in 1:1645){
if (j_pops[i,4] > 0){
sub<-j_sub[(1+(5*(i-1))):(5*i),]
m1<-matrix(nrow=0,ncol=3)
while(nrow(m1) < j_pops[i,4]) {
m2<-matrix(nrow=100,ncol=3)
m2[,1]<-runif(100,max=(max(sub$long,na.rm=T)+.00000001),min = (min(sub$long,na.rm=T)-.00000001))
m2[,2]<-runif(100,max=(max(sub$lat,na.rm=T)+.00000001),min = (min(sub$lat,na.rm=T)-.00000001))
m2[,3]<-point.in.polygon(m2[,1],m2[,2],jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,1],jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,2])
m2<-subset(m2, m2[,3]>0)
m1<-rbind(m1,m2)
m1<-unique(m1)
}
m1<-m1[1:j_pops[i,4],]
m_final<-rbind(m_final,m1)
}
}
jorquelleh_f_points_df<-m_final
save(jorquelleh_f_points_df,file="jorquelleh_f_points_df.RData")
win<- as(jorquelleh,"owin")
m_final[,3]<-as.numeric(m_final[,3])
ppp_jorquelleh_f<-ppp(m_final[,1],m_final[,2],window=win,marks=m_final[,3])
summary(ppp_jorquelleh_f)
plot(ppp_jorquelleh_f,chars=".")
x<-pixellate(ppp_jorquelleh_f,eps=.008333)
summary(x)
plot(x)
dens_jorquelleh_f<-density(ppp_jorquelleh_f,eps=.008333)
summary(dens_jorquelleh_f)
plot(dens_jorquelleh_f)
jorquelleh<-clan[which(clan@data$FIRST_DNAM=="Jorquelleh"),]
plot(jorquelleh)
jorquelleh@data$ID<-rep(1,5)
jorquelleh  <- unionSpatialPolygons(jorquelleh,jorquelleh@data$ID)
plot(jorquelleh)
jorquelleh_f<-point.in.polygon(good_good2$long,good_good2$lat,jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,1],jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,2])
jorquelleh_f<-cbind(good_good2,jorquelleh_f)
jorquelleh_f<-subset(jorquelleh_f,jorquelleh_f>0)
ggplot()+geom_map(data=jorquelleh_f,map=jorquelleh_f,aes(x=long,y=lat,map_id=id))+geom_point(data=point,aes(x=long,y=lat))
j_pops<-jorquelleh_f[,c(6,10:16)]
ids<-unique(j_pops$id)
j_pops[,c(2:8)]<-j_pops[,c(2:8)]/5
sum(j_pops$pop2010)
j_pops<-aggregate(.~id,j_pops,FUN=sum)
j_pops$id<-as.numeric(j_pops$id)
j_pops<-j_pops[order(j_pops$id),]
row.names(j_pops)<-j_pops$id
j_pops[,c(2:8)]<-round(j_pops[,c(2:8)],0)
sum(j_pops[,4])
j_sub<-good_good2[good_good2$id %in% ids,]
m_final<-matrix(nrow=0,ncol=3)
for (i in 1:1645){
if (j_pops[i,4] > 0){
sub<-j_sub[(1+(5*(i-1))):(5*i),]
m1<-matrix(nrow=0,ncol=3)
while(nrow(m1) < j_pops[i,4]) {
m2<-matrix(nrow=100,ncol=3)
m2[,1]<-runif(100,max=(max(sub$long,na.rm=T)+.00000001),min = (min(sub$long,na.rm=T)-.00000001))
m2[,2]<-runif(100,max=(max(sub$lat,na.rm=T)+.00000001),min = (min(sub$lat,na.rm=T)-.00000001))
m2[,3]<-point.in.polygon(m2[,1],m2[,2],jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,1],jorquelleh@polygons[[1]]@Polygons[[1]]@coords[,2])
m2<-subset(m2, m2[,3]>0)
m1<-rbind(m1,m2)
m1<-unique(m1)
}
m1<-m1[1:j_pops[i,4],]
m_final<-rbind(m_final,m1)
}
}
jorquelleh_f_points_df<-m_final
save(jorquelleh_f_points_df,file="jorquelleh_f_points_df.RData")
win<- as(jorquelleh,"owin")
ppp_jorquelleh_f<-ppp(m_final[,1],m_final[,2],window=win)
summary(ppp_jorquelleh_f)
plot(ppp_jorquelleh_f,chars=".")
x<-pixellate(ppp_jorquelleh_f,eps=.008333)
ppm_jorquelleh_f<-ppm(ppp_jorquelleh_f,~pixel,covariates = list(pixel=x))
sim_jorquelleh_f<-simulate(ppm_jorquelleh_f,nsim = 10)
plot(sim_jorquelleh_f,chars=".")
plot(density(sim_jorquelleh_f))
cdf.test(ppp_jorquelleh_f,x,test="ks")
plot(cdf.test(ppp_jorquelleh_f,x,test="ks"))
berman.test(ppp_jorquelleh_f,x)
plot(berman.test(ppp_jorquelleh_f,x))
